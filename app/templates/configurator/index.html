{% extends 'main/base.html' %}

{% block content %}
<link rel="stylesheet" href="configurator.css">

<div class="configurator-container">
    <main class="configurator-steps">
        <h1>КОНФИГУРАТОР ИГРОВОГО ПК</h1>
        
        <!-- Шаг 1: Выбор игры -->
        <section class="config-step active" id="step-game">
            <div class="step-card">
                <div class="step-header">
                    <h2><span class="step-number">1</span> Выберите игру</h2>
                    <p>Укажите игру, для которой собираете конфигурацию</p>
                </div>
                
                <div class="games-grid">
                    <!-- Первая строка -->
                    <div class="game-card" data-game-id="1">
                        <div class="game-icon">
                            <img src="https://cdn.cloudflare.steamstatic.com/steam/apps/730/header.jpg" alt="CS:GO">
                        </div>
                        <h3>Counter-Strike 2</h3>
                        <p>Competitive FPS</p>
                    </div>
                    
                    <div class="game-card" data-game-id="2">
                        <div class="game-icon">
                            <img src="https://cdn.cloudflare.steamstatic.com/steam/apps/570/header.jpg" alt="Dota 2">
                        </div>
                        <h3>Dota 2</h3>
                        <p>MOBA</p>
                    </div>
                    
                    <div class="game-card" data-game-id="3">
                        <div class="game-icon">
                            <img src="https://cdn.cloudflare.steamstatic.com/steam/apps/578080/header.jpg" alt="PUBG">
                        </div>
                        <h3>PUBG: Battlegrounds</h3>
                        <p>Battle Royale</p>
                    </div>
                    
                    <div class="game-card" data-game-id="4">
                        <div class="game-icon">
                            <img src="https://cdn.cloudflare.steamstatic.com/steam/apps/1172470/header.jpg" alt="Apex Legends">
                        </div>
                        <h3>Apex Legends</h3>
                        <p>Tactical Shooter</p>
                    </div>
                    
                    <!-- Вторая строка -->
                    <div class="game-card" data-game-id="5">
                        <div class="game-icon">
                            <img src="https://cdn.cloudflare.steamstatic.com/steam/apps/292030/header.jpg" alt="Witcher 3">
                        </div>
                        <h3>The Witcher 3</h3>
                        <p>RPG</p>
                    </div>
                    
                    <div class="game-card" data-game-id="6">
                        <div class="game-icon">
                            <img src="https://cdn.cloudflare.steamstatic.com/steam/apps/1245620/header.jpg" alt="Elden Ring">
                        </div>
                        <h3>Elden Ring</h3>
                        <p>Action RPG</p>
                    </div>
                    
                    <div class="game-card" data-game-id="7">
                        <div class="game-icon">
                            <img src="https://cdn.cloudflare.steamstatic.com/steam/apps/1811260/header.jpg" alt="Forza Horizon 5">
                        </div>
                        <h3>Forza Horizon 5</h3>
                        <p>Racing</p>
                    </div>
                    
                    <div class="game-card" data-game-id="8">
                        <div class="game-icon">
                            <img src="https://cdn.cloudflare.steamstatic.com/steam/apps/1086940/header.jpg" alt="Baldur's Gate 3">
                        </div>
                        <h3>Baldur's Gate 3</h3>
                        <p>CRPG</p>
                    </div>
                </div>
                
                <!-- Динамическая загрузка игр (если нужно) -->
                <div class="games-grid">
                    {% for game in games %}
                    <div class="game-card" data-game-id="{{ game.id }}">
                        <div class="game-icon">
                            <img src="{{ game.image_url }}" alt="{{ game.name }}">
                        </div>
                        <h3>{{ game.name }}</h3>
                        <p>{{ game.genre }}</p>
                    </div>
                    {% endfor %}
                </div>
                <!-- Обновленная таблица настроек графики с разделением DLSS/FSR -->
                <div class="graphics-settings">
                    <h3 class="settings-title">ИГРОВЫЕ НАСТРОЙКИ ГРАФИКИ</h3>
                    
                    <div class="settings-grid">
                        <!-- Графика -->
                        <div class="settings-row">
                            <div class="settings-label">Графика</div>
                            <div class="settings-options">
                                <select class="settings-select">
                                    <option value="low">Низкие</option>
                                    <option value="medium">Средние</option>
                                    <option value="high" selected>Высокие</option>
                                    <option value="ultra">Ультра</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Разрешение -->
                        <div class="settings-row">
                            <div class="settings-label">Разрешение</div>
                            <div class="settings-options">
                                <select class="settings-select">
                                    <option value="720p">720p (HD)</option>
                                    <option value="1080p" selected>1080p (Full HD)</option>
                                    <option value="1440p">1440p (2K)</option>
                                    <option value="2160p">2160p (4K)</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Частота кадров -->
                        <div class="settings-row">
                            <div class="settings-label">Частота кадров</div>
                            <div class="settings-options">
                                <select class="settings-select">
                                    <option value="30">30 FPS (Минимальная)</option>
                                    <option value="60" selected>60 FPS (Рекомендуемая)</option>
                                    <option value="120">120 FPS (Высокая)</option>
                                    <option value="144">144 FPS (Для киберспорта)</option>
                                    <option value="240">240 FPS (Максимальная)</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Трассировка лучей -->
                        <div class="settings-row">
                            <div class="settings-label">Трассировка лучей</div>
                            <div class="settings-options">
                                <select class="settings-select">
                                    <option value="off">Выключено</option>
                                    <option value="on">Включено</option>
                                    <option value="ultra">Ультра</option>
                                    <option value="overdrive">Overdrive (RTX 40 series)</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Технологии масштабирования -->
                        <div class="scaling-tech">
                            <div class="scaling-column">
                                <div class="settings-label">NVIDIA DLSS</div>
                                <div class="settings-options">
                                    <select class="settings-select dlss-select" name="scaling_tech">
                                        <option value="off">Выключено</option>
                                        <option value="dlss-quality">Качество</option>
                                        <option value="dlss-balanced">Сбалансированный</option>
                                        <option value="dlss-performance">Производительность</option>
                                        <option value="dlss-ultra-performance">Ультра производительность</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="scaling-column">
                                <div class="settings-label">AMD FSR</div>
                                <div class="settings-options">
                                    <select class="settings-select fsr-select" name="scaling_tech">
                                        <option value="off">Выключено</option>
                                        <option value="fsr-quality">Качество</option>
                                        <option value="fsr-balanced">Сбалансированный</option>
                                        <option value="fsr-performance">Производительность</option>
                                        <option value="fsr-ultra-performance">Ультра производительность</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </section>

        <!-- Шаг 2: Бюджет -->
        <section class="config-step" id="step-budget">
            <div class="step-card">
                <div class="step-header">
                    <h2><span class="step-number">2</span> Ваш бюджет</h2>
                    <p>Укажите планируемый бюджет на систему</p>
                </div>
                
                <div class="budget-display">
                    <span id="budgetValue">150 000</span> ₽
                </div>
                
                <div class="range-container">
                    <input type="range" min="50000" max="450000" step="100" value="250000" class="budget-range" id="budgetRange">
                </div>
                
                <div class="budget-markers">
                    <span>50,000 ₽</span>
                    <span>250,000 ₽</span>
                    <span>450,000 ₽</span>
                </div>
                
                <div class="budget-presets">
                    <div class="preset" data-budget="100000">Бюджетная</div>
                    <div class="preset active" data-budget="250000">Оптимальная</div>
                    <div class="preset" data-budget="400000">Максимальная</div>
                </div>
            </div>
        </section>

        <!-- Шаг 3: Пожелания по комплектующим -->
        <section class="config-step" id="step-requirements">
            <div class="step-card">
                <div class="step-header">
                    <h2><span class="step-number">3</span> Ваши требования</h2>
                    <p>Укажите обязательные компоненты или пожелания</p>
                </div>
                
                <div class="requirements-form">
                    <div class="form-group">
                        <label for="cpuBrand">Процессор:</label>
                        <select id="cpuBrand" class="form-select">
                            <option value="any">Любой</option>
                            <option value="intel">Только Intel</option>
                            <option value="amd">Только AMD</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="gpuBrand">Видеокарта:</label>
                        <select id="gpuBrand" class="form-select">
                            <option value="any">Любая</option>
                            <option value="nvidia">Только NVIDIA</option>
                            <option value="amd">Только AMD</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="ramSize">Оперативная память:</label>
                        <select id="ramSize" class="form-select">
                            <option value="16">16 ГБ (минимум)</option>
                            <option value="32" selected>32 ГБ (рекомендуется)</option>
                            <option value="64">64 ГБ (профессионально)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="storage">Накопитель:</label>
                        <select id="storage" class="form-select">
                            <option value="512">512 ГБ HDD</option>
                            <option value="512">512 ГБ SSD</option>
                            <option value="1000">1 ТБ HHD</option>
                            <option value="1000">1 ТБ SSD</option>
                            <option value="2000">2 ТБ SSD</option>
                        </select>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="notes">Дополнительные пожелания:</label>
                        <textarea id="notes" class="form-textarea" placeholder="Например: Корпус с RGB подсветкой, водяное охлаждение..."></textarea>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="configurator-footer">
        <!-- Кнопка "Назад" ведет на Главную -->
        <a href="{{ url_for('post.all') }}" class="btn-prev">
            <svg viewBox="0 0 24 24">
                <path d="M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"/>
            </svg>
            Назад
        </a>
        
        <!-- Кнопка "Далее" ведет на Компоненты -->
        <a href="{{ url_for('components.index') }}" class="btn-next">
            Далее
            <svg viewBox="0 0 24 24">
                <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
            </svg>
        </a>
    </footer>
</div>

<style>
    /* Обновленные стили для кнопок-ссылок */
    .btn-prev, 
    .btn-next {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 12px 24px;
        border-radius: 6px;
        font-weight: 600;
        text-decoration: none;
        transition: all 0.3s ease;
    }
    
    .btn-prev {
        background-color: #252525;
        color: #ff6b00;
        border: 1px solid #333;
    }
    
    .btn-prev:hover {
        background-color: #333;
        border-color: #ff6b00;
    }
    
    .btn-next {
        background-color: #ff6b00;
        color: #121212;
    }
    
    .btn-next:hover {
        background-color: #dd6b00;
        transform: translateY(-2px);
    }

    /* Обновленные стили для новой структуры */
    .games-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin-top: 20px;
    }
    
    .game-card {
        cursor: pointer;
        transition: all 0.3s ease;
        border-radius: 8px;
        overflow: hidden;
        background: #1e1e1e;
        border: 2px solid transparent;
    }
    
    .game-card.selected {
        border-color: #ff6b00;
        box-shadow: 0 0 15px #aa6b00;
    }
    
    .game-card:hover {
        transform: translateY(-5px);
    }
    
    .budget-presets {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-top: 25px;
    }
    
    .budget-presets .preset {
        padding: 10px 20px;
        background: #252525;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .budget-presets .preset.active {
        background: #ff6b00;
        color: #000;
        font-weight: 600;
    }
    
    .requirements-form {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-top: 20px;
    }
    
    .form-group {
        margin-bottom: 15px;
    }
    
    .form-group label {
        display: block;
        margin-bottom: 8px;
        color: #ff6b00;
    }
    
    .form-select, .form-textarea {
        width: 100%;
        padding: 12px;
        background: #252525;
        border: 1px solid #333;
        border-radius: 6px;
        color: #ff9500;
    }
    
    .form-textarea {
        min-height: 100px;
        resize: vertical;
    }
    
    
    .full-width {
        grid-column: span 2;
    }
    /* Обновленные стили для ползунка бюджета */
    .range-container {
    position: relative;
    padding: 15px 0;
}

input[type="range"].budget-range {
    -webkit-appearance: none;
    width: 100%;
    height: 6px;
    margin: 10px 0;
    background: #333;
    border-radius: 3px;
    outline: none;
}

/* WebKit (Chrome/Safari) */
input[type="range"].budget-range::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: #ff6b00;
    cursor: pointer;
    border: 3px solid #121212;
    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    margin-top: -9px; /* Выравнивание по вертикали */
    position: relative;
    z-index: 2;
}

input[type="range"].budget-range::-webkit-slider-runnable-track {
    height: 6px;
    background: linear-gradient(to right, #ff6b00, #ff9500);
    border-radius: 3px;
}

/* Firefox */
input[type="range"].budget-range::-moz-range-thumb {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: #ff6b00;
    cursor: pointer;
    border: 3px solid #121212;
    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    position: relative;
    z-index: 2;
}

input[type="range"].budget-range::-moz-range-track {
    height: 6px;
    background: #333;
    border-radius: 3px;
}

input[type="range"].budget-range::-moz-range-progress {
    height: 6px;
    background: linear-gradient(to right, #ffb600, #ff9500);
    border-radius: 3px;
}
    
    /* Подписи под ползунком */
    .range-labels {
        display: flex;
        justify-content: space-between;
        margin-top: 8px;
        color: #b0b0b0;
        font-size: 0.9em;
    }
    
    .budget-display {
        font-size: 1.8em;
        font-weight: 700;
        color: #ff6b00;
        margin: 10px 0;
        text-align: center;
    }
    
    .budget-markers {
        display: flex;
        justify-content: space-between;
        margin-top: 5px;
        color: #b0b0b0;
    }

    /* Обновленные стили для таблицы настроек */
    .graphics-settings {
        margin-top: 40px;
        background: #1e1e1e;
        border-radius: 10px;
        padding: 20px;
        border: 1px solid #333;
    }
    
    .settings-title {
        color: #ff6b00;
        text-align: center;
        margin-bottom: 20px;
        font-size: 1.5em;
    }
    
    .settings-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .settings-row {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .settings-label {
        color: #b0b0b0;
        font-size: 1.1em;
        margin-bottom: 5px;
    }
    
    .settings-select {
        width: 100%;
        padding: 10px 15px;
        background: #252525;
        border: 1px solid #444;
        border-radius: 6px;
        color: #ff9500;
        font-size: 1em;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .settings-select:hover {
        border-color: #ff6b00;
    }
    
    .settings-select:focus {
        outline: none;
        border-color: #ff9500;
        box-shadow: 0 0 0 2px rgba(255, 149, 0, 0.2);
    }
    
    /* Стили для раздела масштабирования */
    .scaling-tech {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-top: 10px;
    }
    
    .scaling-column {
        background: #252525;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #333;
    }
    
    .scaling-column .settings-label {
        color: #ff9500;
        text-align: center;
        font-weight: bold;
    }
    
    .scaling-column:nth-child(1) {
        border-color: #76b900; /* NVIDIA зеленый */
    }
    
    .scaling-column:nth-child(2) {
        border-color: #ed1c24; /* AMD красный */
    }
    
    @media (min-width: 768px) {
        .settings-grid {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .scaling-tech {
            grid-column: span 2;
        }
    }
</style>

<script>
    // Обработка выбора игры
    document.querySelectorAll('.game-card').forEach(card => {
        card.addEventListener('click', function() {
            document.querySelectorAll('.game-card').forEach(c => c.classList.remove('selected'));
            this.classList.add('selected');

            const selectedGameId = this.dataset.gameId;
            console.log('Выбрана игра с ID:', selectedGameId);
        });
    });
    
    // Обработка пресетов бюджета
    document.querySelectorAll('.budget-presets .preset').forEach(preset => {
        preset.addEventListener('click', function() {
            document.querySelectorAll('.budget-presets .preset').forEach(p => p.classList.remove('active'));
            this.classList.add('active');
            const budget = this.dataset.budget;
            document.getElementById('budgetRange').value = budget;
            document.getElementById('budgetValue').textContent = new Intl.NumberFormat('ru-RU').format(budget);
        });
    });
    
    // Обновление бюджета при движении ползунка
    document.getElementById('budgetRange').addEventListener('input', function() {
        const value = this.value;
        document.getElementById('budgetValue').textContent = new Intl.NumberFormat('ru-RU').format(value);
    });

    // Обработка выбора настроек
    document.querySelectorAll('.settings-cell input[type="radio"]').forEach(radio => {
        radio.addEventListener('change', function() {
            // Можно добавить логику обработки выбора
            console.log(`Выбрано: ${this.name} = ${this.value}`);
        });
    });

    // Обработчики для выбора настроек
    document.querySelectorAll('.settings-select').forEach(select => {
        select.addEventListener('change', function() {
            console.log(`Изменено: ${this.previousElementSibling.textContent} = ${this.value}`);
        });
    });

    // Обработка взаимоисключающего выбора DLSS/FSR
    document.querySelectorAll('.dlss-select, .fsr-select').forEach(select => {
        select.addEventListener('change', function() {
            const isDLSS = this.classList.contains('dlss-select');
            const otherSelect = isDLSS 
                ? document.querySelector('.fsr-select') 
                : document.querySelector('.dlss-select');
            
            // Если выбрано что-то кроме "Выключено" в текущем селекте
            if (this.value !== 'off') {
                otherSelect.value = 'off'; // Отключаем другой селект
            }
            
            console.log(`Выбрано: ${isDLSS ? 'DLSS' : 'FSR'} = ${this.value}`);
        });
    });
</script>

<script src="configurator.js"></script>
{% endblock %}